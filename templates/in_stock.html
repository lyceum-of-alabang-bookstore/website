
<html lang="en">
<head>
    <h1><font color="yellow">LYCEUM OF ALABANG BOOKSTORE</font></h1>
    <title>In-Stock Items</title>
    <link rel="stylesheet" href="/static/style.css">
    <style> /* default formats */
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
			margin-top: 60px;
        }
        h1 {
            position: absolute;
            top: 6%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 1px solid #ccc;
            margin-top: 0px;
            width: 100%;
            padding: 15px 50px;
            border-radius: 10px;
            background-color: rgb(0, 0, 204);
            box-shadow: 2px 2px 8px rgba(0,0,0,0.1);
            text-align: center;
        }
        .items-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        .item-card {
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 10px;
            background-color: white;
            box-shadow: 2px 2px 8px rgba(0,0,0,0.1);
            text-align: center;
        }
        .item-card h3 {
            margin: 10px 0;
        }
        .item-card p {
            margin: 5px 0;
        }
        .add-btn {
            margin-top: 10px;
            padding: 8px 15px;
            background-color: #28a745;
            color: white;
            border: none;
			font-size: 16px;
            border-radius: 6px;
            cursor: pointer;
        }
        .add-btn:hover {
            background-color: #218838;
        }
		.view-btn {
			margin-top: 10px;
			padding: 10px 20px;
			background-color: #050f3b;
			border: none;
			border-radius: 6px;
			cursor: pointer;
			font-size: 16px;
			color: white;
		}
		.view-btn:hover {
			background-color: #5f70b9;
		}		
    </style>
</head>
<body>

    <h2>In-Stock Items</h2>

    <select id="categoryFilter" onchange="filterItems()" style="padding: 10px; margin-left: 10px;">
        <option value="">All Categories</option>
        <option value="School supplies">School Supplies</option>
        <option value="Uniforms">Uniforms</option>
        <option value="Others">Others</option>
    </select>

    <input type="text" id="searchInput" placeholder="Search..." onkeyup="searchItems()" style="padding: 10px; width: 300px; margin-bottom: 20px;">

    <button onclick="viewOrderList()" class="view-btn">🛒 View List</button>

    <div id="items-container" class="items-grid"></div>

    <script>
    let inStockItems = [];
    let orderList = JSON.parse(localStorage.getItem('orderList')) || [];

    fetch('/api/in-stock')
        .then(response => response.json())
        .then(data => {
            inStockItems = data;
            displayItems(inStockItems);
        });

    function displayItems(items) {
        const container = document.getElementById('items-container');
        container.innerHTML = '';
        items.forEach(item => {
            const card = document.createElement('div');
            card.className = 'item-card';
            card.innerHTML = `
                <h3>${item.name}</h3>
                <p>${item.category}</p>
                <p><b><h3>₱${item.price}</h3></b></p>
                <p>✅ In-stock</p>
                <button class="add-btn" onclick='addToList(${JSON.stringify(item)})'>Add to List</button>
            `;
            container.appendChild(card);
        });
    }

    function addToList(item) {
        const existing = orderList.find(i => i.id === item.id);
        if (!existing) {
            orderList.push({...item, quantity: 1});
            alert('✅ Item added to list!');
        } else {
            alert('⚠️ Item already in list! View List to adjust quantity');
        }
        localStorage.setItem('orderList', JSON.stringify(orderList));
    }

    function searchItems() {
        const keyword = document.getElementById('searchInput').value.toLowerCase();
        const filtered = inStockItems.filter(item => item.name.toLowerCase().includes(keyword));
        displayItems(filtered);
    }

    function filterItems() {
        const keyword = document.getElementById('searchInput').value.toLowerCase();
        const category = document.getElementById('categoryFilter').value;
        let filtered = inStockItems;  

        if (keyword) {
            filtered = filtered.filter(item => item.name.toLowerCase().includes(keyword));
        }
        if (category) {
            filtered = filtered.filter(item => item.category === category);
        }

        displayItems(filtered);
    }

    function viewOrderList() {
        window.location.href = '/order_summary.html';
    }
    </script>

</body>
</html>
